<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  
  <title>pavelShen的个人博客</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="把笔记里的内容慢慢迁移过来">
<meta property="og:type" content="website">
<meta property="og:title" content="pavelShen的个人博客">
<meta property="og:url" content="https://github.com/pavelShen/index.html">
<meta property="og:site_name" content="pavelShen的个人博客">
<meta property="og:description" content="把笔记里的内容慢慢迁移过来">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="pavelShen的个人博客">
<meta name="twitter:description" content="把笔记里的内容慢慢迁移过来">
  
    <link rel="alternate" href="/atom.xml" title="pavelShen的个人博客" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.png">
  
  
    <link href="//fonts.googleapis.com/css?family=Source+Code+Pro" rel="stylesheet" type="text/css">
  
  <link rel="stylesheet" href="/css/style.css">
  

</head>

<body>
  
    <div id="container">
      <div id="wrap">
        <header id="header">
  <div id="banner"></div>
  <div id="header-outer" class="outer">
    <div id="header-title" class="inner">
      <h1 id="logo-wrap">
        <a href="/" id="logo">pavelShen的个人博客</a>
      </h1>
      
        <h2 id="subtitle-wrap">
          <a href="/" id="subtitle">JUST FOR FUN</a>
        </h2>
      
    </div>
    <div id="header-inner" class="inner">
      <nav id="main-nav">
        <a id="main-nav-toggle" class="nav-icon"></a>
        
          <a class="main-nav-link" href="/">Home</a>
        
          <a class="main-nav-link" href="/archives">Archives</a>
        
          <a class="main-nav-link" href="/demo">Demo</a>
        
      </nav>
      <nav id="sub-nav">
        
          <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
        
        <a id="nav-search-btn" class="nav-icon" title="Search"></a>
      </nav>
      <div id="search-form-wrap">
        <form action="//google.com/search" method="get" accept-charset="UTF-8" class="search-form"><input type="search" name="q" results="0" class="search-form-input" placeholder="Search"><button type="submit" class="search-form-submit">&#xF002;</button><input type="hidden" name="sitesearch" value="https://github.com/pavelShen"></form>
      </div>
    </div>
  </div>
</header>
        <div class="outer">
          <section id="main">
  
    <article id="post-codewar-04" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/09/06/codewar-04/" class="article-date">
  <time datetime="2017-09-05T16:50:14.000Z" itemprop="datePublished">2017-09-06</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/09/06/codewar-04/">codewar-04</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="codewar刷题之旅开始啦"><a href="#codewar刷题之旅开始啦" class="headerlink" title="codewar刷题之旅开始啦~"></a>codewar刷题之旅开始啦~</h1><h2 id="Title-Case-标题风格，传入一个title，首字母大写，如果传入例外的数组，则例外的短字符大小写不变，首字母始终大写"><a href="#Title-Case-标题风格，传入一个title，首字母大写，如果传入例外的数组，则例外的短字符大小写不变，首字母始终大写" class="headerlink" title="Title Case(标题风格，传入一个title，首字母大写，如果传入例外的数组，则例外的短字符大小写不变，首字母始终大写)"></a>Title Case(标题风格，传入一个title，首字母大写，如果传入例外的数组，则例外的短字符大小写不变，首字母始终大写)</h2><p>titleCase(‘a clash of KINGS’, ‘a an the of’) // should return: ‘A Clash of Kings’<br>titleCase(‘THE WIND IN THE WILLOWS’, ‘The In’) // should return: ‘The Wind in the Willows’<br>titleCase(‘the quick brown fox’) // should return: ‘The Quick Brown Fox’</p>
<h4 id="强写，感觉写复杂了。。。。。看看别人的答案吧"><a href="#强写，感觉写复杂了。。。。。看看别人的答案吧" class="headerlink" title="强写，感觉写复杂了。。。。。看看别人的答案吧"></a>强写，感觉写复杂了。。。。。看看别人的答案吧</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">titleCase</span>(<span class="params">title, minorWords</span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> result </div><div class="line">  <span class="keyword">let</span> temp = title.toLowerCase().replace(<span class="regexp">/(^|\s)([A-Za-z])/g</span>,(match)=&gt;&#123;</div><div class="line">    <span class="keyword">return</span> match.toUpperCase()</div><div class="line">  &#125;)</div><div class="line">  </div><div class="line">  <span class="keyword">if</span>(minorWords)&#123;</div><div class="line">    <span class="keyword">let</span> arrTitle = temp.split(<span class="string">' '</span>)</div><div class="line">    <span class="keyword">let</span> arrMinor = minorWords.split(<span class="string">' '</span>).map(<span class="function">(<span class="params">item</span>)=&gt;</span>&#123;</div><div class="line">      <span class="keyword">return</span> item.toLowerCase()</div><div class="line">    &#125;)</div><div class="line">    </div><div class="line">    result = arrTitle.map(<span class="function">(<span class="params">item,index</span>)=&gt;</span>&#123;</div><div class="line">      <span class="keyword">if</span>(arrMinor.indexOf(item.toLowerCase())!== <span class="number">-1</span> &amp;&amp; index !== <span class="number">0</span>)&#123;</div><div class="line">        <span class="keyword">return</span> item.toLowerCase()</div><div class="line">      &#125;</div><div class="line">      <span class="keyword">else</span> &#123;</div><div class="line">        <span class="keyword">return</span> item</div><div class="line">      &#125;</div><div class="line">    &#125;)</div><div class="line">    </div><div class="line">    result = result.join(<span class="string">' '</span>)</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">else</span>&#123;</div><div class="line">    result = temp</div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  <span class="keyword">return</span> result</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="一个思路，设置一个首字母大写的方法，切分数组后，根据条件决定是否执行该方法"><a href="#一个思路，设置一个首字母大写的方法，切分数组后，根据条件决定是否执行该方法" class="headerlink" title="一个思路，设置一个首字母大写的方法，切分数组后，根据条件决定是否执行该方法"></a>一个思路，设置一个首字母大写的方法，切分数组后，根据条件决定是否执行该方法</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">String</span>.prototype.capitalize = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.charAt(<span class="number">0</span>).toUpperCase() + <span class="keyword">this</span>.slice(<span class="number">1</span>).toLowerCase();</div><div class="line">&#125;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">titleCase</span>(<span class="params">title, minorWords</span>) </span>&#123;  </div><div class="line">  <span class="keyword">var</span> titleAr = title.toLowerCase().split(<span class="string">' '</span>),</div><div class="line">      minorWordsAr = minorWords ? minorWords.toLowerCase().split(<span class="string">' '</span>) : [];</div><div class="line">    </div><div class="line">  <span class="keyword">return</span> titleAr.map(<span class="function"><span class="keyword">function</span>(<span class="params">e, i</span>)</span>&#123;<span class="keyword">return</span> minorWordsAr.indexOf(e) === <span class="number">-1</span> || i === <span class="number">0</span> ? e.capitalize() : e &#125;)</div><div class="line">                .join(<span class="string">' '</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://github.com/pavelShen/2017/09/06/codewar-04/" data-id="cj77t6lam000s7vvg1vyb42ei" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/codewar/">codewar</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-codewar-03" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/09/05/codewar-03/" class="article-date">
  <time datetime="2017-09-04T16:50:14.000Z" itemprop="datePublished">2017-09-05</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/09/05/codewar-03/">codewar-03</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="codewar刷题之旅开始啦"><a href="#codewar刷题之旅开始啦" class="headerlink" title="codewar刷题之旅开始啦~"></a>codewar刷题之旅开始啦~</h1><h2 id="Format-a-string-of-names-like-‘Bart-Lisa-amp-Maggie’"><a href="#Format-a-string-of-names-like-‘Bart-Lisa-amp-Maggie’" class="headerlink" title="Format a string of names like ‘Bart, Lisa &amp; Maggie’."></a>Format a string of names like ‘Bart, Lisa &amp; Maggie’.</h2><h4 id="自己写的"><a href="#自己写的" class="headerlink" title="自己写的"></a>自己写的</h4><p>偷鸡的使用了replace的分组，如何用正则获取最后一次出现的指定字符可以研究下<br><code>/,(?!.*,)/</code>  逻辑：匹配后面没有逗号的逗号</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">list</span>(<span class="params">names</span>)</span>&#123;</div><div class="line">  <span class="keyword">let</span> result</div><div class="line">  <span class="keyword">let</span> nameArr = names.map(<span class="function"><span class="keyword">function</span>(<span class="params">item</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> item.name</div><div class="line">  &#125;)</div><div class="line">  </div><div class="line">  result = nameArr.join(<span class="string">', '</span>)</div><div class="line">  <span class="keyword">return</span> result.replace(<span class="regexp">/(.*)(,\s)/</span>,<span class="function"><span class="keyword">function</span>(<span class="params">match,p1,p2</span>)</span>&#123;</div><div class="line">		  <span class="keyword">return</span> p1 + <span class="string">' &amp; '</span></div><div class="line">		&#125;)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="reduce-感觉这题就是给reduce打造的。。。"><a href="#reduce-感觉这题就是给reduce打造的。。。" class="headerlink" title="reduce 感觉这题就是给reduce打造的。。。"></a>reduce 感觉这题就是给reduce打造的。。。</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">list</span>(<span class="params">names</span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> names.reduce(<span class="function"><span class="keyword">function</span>(<span class="params">prev, current, index, array</span>)</span>&#123;</div><div class="line">    <span class="keyword">if</span> (index === <span class="number">0</span>)&#123;</div><div class="line">      <span class="keyword">return</span> current.name;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">else</span> <span class="keyword">if</span> (index === array.length - <span class="number">1</span>)&#123;</div><div class="line">      <span class="keyword">return</span> prev + <span class="string">' &amp; '</span> + current.name;</div><div class="line">    &#125; </div><div class="line">    <span class="keyword">else</span> &#123;</div><div class="line">      <span class="keyword">return</span> prev + <span class="string">', '</span> + current.name;</div><div class="line">    &#125;</div><div class="line">  &#125;, <span class="string">''</span>);</div><div class="line"> &#125;</div></pre></td></tr></table></figure>
<h4 id="把最后一个名字用pop弹出并存起来（不错的想法）"><a href="#把最后一个名字用pop弹出并存起来（不错的想法）" class="headerlink" title="把最后一个名字用pop弹出并存起来（不错的想法）"></a>把最后一个名字用pop弹出并存起来（不错的想法）</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">list</span>(<span class="params">names</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> xs = names.map(<span class="function"><span class="params">p</span> =&gt;</span> p.name)</div><div class="line">  <span class="keyword">var</span> x = xs.pop()</div><div class="line">  <span class="keyword">return</span> xs.length ? xs.join(<span class="string">", "</span>) + <span class="string">" &amp; "</span> + x : x || <span class="string">""</span></div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<h2 id="Sum-of-two-lowest-positive-integers-（数组最小的2个值相加）"><a href="#Sum-of-two-lowest-positive-integers-（数组最小的2个值相加）" class="headerlink" title="Sum of two lowest positive integers （数组最小的2个值相加）"></a>Sum of two lowest positive integers （数组最小的2个值相加）</h2><h4 id="先排序再求和，但是按照算法复杂度来说，复杂了"><a href="#先排序再求和，但是按照算法复杂度来说，复杂了" class="headerlink" title="先排序再求和，但是按照算法复杂度来说，复杂了"></a>先排序再求和，但是按照算法复杂度来说，复杂了</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">sumTwoSmallestNumbers</span>(<span class="params">numbers</span>) </span>&#123;  </div><div class="line">  <span class="comment">//Code here</span></div><div class="line">  <span class="keyword">let</span> temp = numbers.slice()</div><div class="line">  <span class="keyword">let</span> sortedNum = temp.sort(<span class="function">(<span class="params">a,b</span>) =&gt;</span> a-b)</div><div class="line">  <span class="keyword">return</span> sortedNum[<span class="number">0</span>] + sortedNum[<span class="number">1</span>]</div><div class="line">&#125;;</div></pre></td></tr></table></figure>
<h4 id="设置2个变量获取最小的2个值，和自己写的demo中获取最大的2个值-是一个思路"><a href="#设置2个变量获取最小的2个值，和自己写的demo中获取最大的2个值-是一个思路" class="headerlink" title="设置2个变量获取最小的2个值，和自己写的demo中获取最大的2个值 是一个思路"></a>设置2个变量获取最小的2个值，和自己写的demo中获取最大的2个值 是一个思路</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">sumTwoSmallestNumbers</span>(<span class="params">numbers</span>) </span>&#123;  </div><div class="line">  <span class="keyword">var</span> min = <span class="built_in">Number</span>.MAX_SAFE_INTEGER;</div><div class="line">  <span class="keyword">var</span> secondMin = <span class="built_in">Number</span>.MAX_SAFE_INTEGER;</div><div class="line">  </div><div class="line">  <span class="keyword">var</span> n;</div><div class="line">  <span class="keyword">for</span> (i = <span class="number">0</span>; i &lt; numbers.length; i++) &#123;</div><div class="line">    n = numbers[i];</div><div class="line">    <span class="keyword">if</span>(n &lt; min) &#123;</div><div class="line">      secondMin = min;</div><div class="line">      min = n;</div><div class="line">    &#125; <span class="keyword">else</span> <span class="keyword">if</span>( n &lt; secondMin ) &#123;</div><div class="line">      secondMin = n;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  <span class="keyword">return</span> min + secondMin;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<h2 id="Get-the-Middle-Character-获取字符串中间的部分，长度奇数返回1个字符，偶数返回2个"><a href="#Get-the-Middle-Character-获取字符串中间的部分，长度奇数返回1个字符，偶数返回2个" class="headerlink" title="Get the Middle Character(获取字符串中间的部分，长度奇数返回1个字符，偶数返回2个)"></a>Get the Middle Character(获取字符串中间的部分，长度奇数返回1个字符，偶数返回2个)</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getMiddle</span>(<span class="params">s</span>)</span>&#123;</div><div class="line">  <span class="comment">//Code goes here!</span></div><div class="line">  <span class="keyword">let</span> result</div><div class="line">  <span class="keyword">let</span> length = s.length</div><div class="line">  <span class="keyword">let</span> halfIndex = <span class="built_in">Math</span>.floor(length / <span class="number">2</span>)</div><div class="line">  <span class="keyword">let</span> isEven = length % <span class="number">2</span> === <span class="number">0</span></div><div class="line">  <span class="keyword">if</span>(isEven)&#123;</div><div class="line">    result = s.slice(halfIndex<span class="number">-1</span>,halfIndex+<span class="number">1</span>)</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">else</span>&#123;</div><div class="line">    result = s.charAt(halfIndex)</div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  <span class="keyword">return</span> result</div><div class="line">&#125;</div></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://github.com/pavelShen/2017/09/05/codewar-03/" data-id="cj77t6laj000q7vvgf125pwgo" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/codewar/">codewar</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-codewar-02" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/09/04/codewar-02/" class="article-date">
  <time datetime="2017-09-04T14:50:14.000Z" itemprop="datePublished">2017-09-04</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/09/04/codewar-02/">codewar-02</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="codewar刷题之旅开始啦"><a href="#codewar刷题之旅开始啦" class="headerlink" title="codewar刷题之旅开始啦~"></a>codewar刷题之旅开始啦~</h1><h2 id="Array-diff-在数组a中去除数组b的元素"><a href="#Array-diff-在数组a中去除数组b的元素" class="headerlink" title="Array.diff (在数组a中去除数组b的元素)"></a>Array.diff (在数组a中去除数组b的元素)</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">array_diff</span>(<span class="params">a, b</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> a.filter(<span class="function">(<span class="params">item</span>) =&gt;</span> b.indexOf(item) === <span class="number">-1</span> ) </div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<h2 id="List-Filtering-过滤数组，删除数组中的字符串"><a href="#List-Filtering-过滤数组，删除数组中的字符串" class="headerlink" title="List Filtering (过滤数组，删除数组中的字符串)"></a>List Filtering (过滤数组，删除数组中的字符串)</h2><p>和上题类似，一个filter解决</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter_list</span>(<span class="params">l</span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> toString = <span class="built_in">Object</span>.prototype.toString</div><div class="line">  <span class="keyword">return</span> l.filter(<span class="function">(<span class="params">item</span>) =&gt;</span> toString.call(item) !==<span class="string">'[object String]'</span>)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<p>基本类型，用typeof判断就可以了！不必使用通用方法</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">filter_list</span>(<span class="params">l</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> l.filter( <span class="function"><span class="keyword">function</span>(<span class="params">elem</span>)</span>&#123;<span class="keyword">return</span> <span class="keyword">typeof</span> elem != <span class="string">"string"</span>&#125; )</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<h2 id="Vowel-Count-找出字符串中元音字母的个数"><a href="#Vowel-Count-找出字符串中元音字母的个数" class="headerlink" title="Vowel Count(找出字符串中元音字母的个数)"></a>Vowel Count(找出字符串中元音字母的个数)</h2><h4 id="无脑的循环遍历，看了答案，忘记考虑大写的元音字母了"><a href="#无脑的循环遍历，看了答案，忘记考虑大写的元音字母了" class="headerlink" title="无脑的循环遍历，看了答案，忘记考虑大写的元音字母了"></a>无脑的循环遍历，看了答案，忘记考虑大写的元音字母了</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getCount</span>(<span class="params">str</span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> vowelsCount = <span class="number">0</span>;</div><div class="line">  <span class="keyword">let</span> vowelCollection = [<span class="string">'a'</span>,<span class="string">'e'</span>,<span class="string">'i'</span>,<span class="string">'o'</span>,<span class="string">'u'</span>]</div><div class="line">  </div><div class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> item <span class="keyword">of</span> str)&#123;</div><div class="line">    <span class="keyword">if</span>(vowelCollection.indexOf(item)!==<span class="number">-1</span>)&#123;</div><div class="line">      vowelsCount ++</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  <span class="keyword">return</span> vowelsCount;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="match方案-不错的思路"><a href="#match方案-不错的思路" class="headerlink" title="match方案,不错的思路"></a>match方案,不错的思路</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">getCount</span>(<span class="params">str</span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> (str.match(<span class="regexp">/[aeiou]/ig</span>)||[]).length;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://github.com/pavelShen/2017/09/04/codewar-02/" data-id="cj77t6lai000o7vvgud59tit5" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/codewar/">codewar</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-codewar-01" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/09/03/codewar-01/" class="article-date">
  <time datetime="2017-09-03T08:53:14.000Z" itemprop="datePublished">2017-09-03</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/09/03/codewar-01/">codewar-01</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h1 id="codewar刷题之旅开始啦"><a href="#codewar刷题之旅开始啦" class="headerlink" title="codewar刷题之旅开始啦~"></a>codewar刷题之旅开始啦~</h1><h2 id="Binary-Addition（二进制加法）"><a href="#Binary-Addition（二进制加法）" class="headerlink" title="Binary Addition（二进制加法）"></a>Binary Addition（二进制加法）</h2><h4 id="toString-NaN"><a href="#toString-NaN" class="headerlink" title="toString"></a>toString</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">addBinary</span>(<span class="params">a,b</span>)</span>&#123;</div><div class="line">  <span class="keyword">return</span> (a+b).toString(<span class="number">2</span>)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="原生"><a href="#原生" class="headerlink" title="原生"></a>原生</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">addBinary</span>(<span class="params">a,b</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> sum = <span class="built_in">Math</span>.abs(a+b)</div><div class="line">  <span class="keyword">var</span> sumPrefix = a+b&gt;=<span class="number">0</span> ? <span class="string">''</span> : <span class="string">'-'</span></div><div class="line">  <span class="keyword">var</span> result = <span class="number">0</span></div><div class="line">  </div><div class="line">  <span class="keyword">while</span>(sum&gt;<span class="number">0</span>)&#123;</div><div class="line">    result = ((sum % <span class="number">2</span>) + result).toString()</div><div class="line">    sum = <span class="built_in">Math</span>.floor(sum / <span class="number">2</span>)</div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  <span class="keyword">return</span> sumPrefix+result</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<h2 id="Find-The-Parity-Outlier-（寻找奇偶异常点）"><a href="#Find-The-Parity-Outlier-（寻找奇偶异常点）" class="headerlink" title="Find The Parity Outlier （寻找奇偶异常点）"></a>Find The Parity Outlier （寻找奇偶异常点）</h2><p>[2, 4, 0, 100, 4, 11, 2602, 36]</p>
<p>Should return: 11</p>
<p>[160, 3, 1719, 19, 11, 13, -21]</p>
<p>Should return: 160</p>
<h4 id="注意点"><a href="#注意点" class="headerlink" title="注意点"></a>注意点</h4><p>使用javascript取余的时候，负数得到的余值也为负数</p>
<h4 id="自己写的，偷懒多循环了3个数字"><a href="#自己写的，偷懒多循环了3个数字" class="headerlink" title="自己写的，偷懒多循环了3个数字"></a>自己写的，偷懒多循环了3个数字</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">findOutlier</span>(<span class="params">integers</span>)</span>&#123;</div><div class="line">  <span class="keyword">let</span> arrayType,isOdd=<span class="number">0</span>,isEven=<span class="number">0</span></div><div class="line">  </div><div class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> i=<span class="number">0</span>;i&lt;<span class="number">3</span>;i++)&#123;</div><div class="line">    <span class="built_in">Math</span>.abs(integers[i]%<span class="number">2</span>)===<span class="number">0</span> ? (isEven ++) : (isOdd ++)</div><div class="line">  &#125;</div><div class="line">  </div><div class="line">  arrayType = (isEven&gt;isOdd)?<span class="string">'even'</span>:<span class="string">'odd'</span></div><div class="line">  </div><div class="line">  <span class="keyword">for</span>(<span class="keyword">let</span> item <span class="keyword">of</span> integers)&#123;</div><div class="line">    <span class="keyword">if</span>(arrayType===<span class="string">'even'</span>)&#123;</div><div class="line">      <span class="keyword">if</span>(<span class="built_in">Math</span>.abs(item % <span class="number">2</span>) === <span class="number">1</span>)&#123;</div><div class="line">        <span class="keyword">return</span> item</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">else</span>&#123;</div><div class="line">      <span class="keyword">if</span>(<span class="built_in">Math</span>.abs(item % <span class="number">2</span>) === <span class="number">0</span>)&#123;</div><div class="line">        <span class="keyword">return</span> item</div><div class="line">      &#125;</div><div class="line">    &#125;</div><div class="line">  &#125;</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="利用了filter返回数组的特性"><a href="#利用了filter返回数组的特性" class="headerlink" title="利用了filter返回数组的特性"></a>利用了filter返回数组的特性</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">findOutlier</span>(<span class="params">int</span>)</span>&#123;</div><div class="line">  <span class="keyword">var</span> even = int.filter(<span class="function"><span class="params">a</span>=&gt;</span>a%<span class="number">2</span>==<span class="number">0</span>);</div><div class="line">  <span class="keyword">var</span> odd = int.filter(<span class="function"><span class="params">a</span>=&gt;</span>a%<span class="number">2</span>!==<span class="number">0</span>);</div><div class="line">  <span class="keyword">return</span> even.length==<span class="number">1</span>? even[<span class="number">0</span>] : odd[<span class="number">0</span>];</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<hr>
<h2 id="Jaden-Casing-Strings（首字母大写）"><a href="#Jaden-Casing-Strings（首字母大写）" class="headerlink" title="Jaden Casing Strings（首字母大写）"></a>Jaden Casing Strings（首字母大写）</h2><p>比较令人不解的是 为何第一个正则里面如果直接返回p1.toUpperCase() 会将空格替换掉？<br>replace函数的意思是将所有匹配到的内容替换掉，所以虽然只修改了p1但是也会把空格给替换掉</p>
<h4 id="又low了，先处理了首字母，再处理空格后面的英文"><a href="#又low了，先处理了首字母，再处理空格后面的英文" class="headerlink" title="又low了，先处理了首字母，再处理空格后面的英文"></a>又low了，先处理了首字母，再处理空格后面的英文</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">String</span>.prototype.toJadenCase = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">let</span> reg = <span class="regexp">/\s([a-z])/g</span></div><div class="line">  <span class="keyword">let</span> handledStr = handleFirstLetter(<span class="keyword">this</span>)</div><div class="line">  <span class="keyword">return</span> handledStr.replace(reg,(match,p1)=&gt;&#123;</div><div class="line">    <span class="keyword">return</span> <span class="string">' '</span>+p1.toUpperCase()</div><div class="line">  &#125;)</div><div class="line">&#125;;</div><div class="line"></div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">handleFirstLetter</span>(<span class="params">str</span>)</span>&#123;</div><div class="line">  <span class="keyword">let</span> reg = <span class="regexp">/^[a-z]/</span></div><div class="line">  <span class="keyword">return</span> str.replace(reg,(match)=&gt;&#123;</div><div class="line">    <span class="keyword">return</span> match.toUpperCase()</div><div class="line">  &#125;)</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="先拆了再组合是个很好的思路"><a href="#先拆了再组合是个很好的思路" class="headerlink" title="先拆了再组合是个很好的思路"></a>先拆了再组合是个很好的思路</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">String</span>.prototype.toJadenCase = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123; </div><div class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.split(<span class="string">" "</span>).map(<span class="function"><span class="keyword">function</span>(<span class="params">word</span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> word.charAt(<span class="number">0</span>).toUpperCase() + word.slice(<span class="number">1</span>);</div><div class="line">  &#125;).join(<span class="string">" "</span>);</div><div class="line">&#125;</div></pre></td></tr></table></figure>
<h4 id="一个正则搞定"><a href="#一个正则搞定" class="headerlink" title="一个正则搞定"></a>一个正则搞定</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line"><span class="built_in">String</span>.prototype.toJadenCase = <span class="function"><span class="keyword">function</span> (<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">return</span> <span class="keyword">this</span>.replace(<span class="regexp">/(^|\s)[a-z]/g</span>, <span class="function"><span class="keyword">function</span>(<span class="params">x</span>)</span>&#123;     <span class="keyword">return</span> x.toUpperCase(); &#125;);</div><div class="line">  &#125;;</div></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://github.com/pavelShen/2017/09/03/codewar-01/" data-id="cj77t6lah000l7vvgo04sczbh" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/codewar/">codewar</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-微信小程序跨页面通信解决思路" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/08/12/微信小程序跨页面通信解决思路/" class="article-date">
  <time datetime="2017-08-12T15:49:19.000Z" itemprop="datePublished">2017-08-12</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/08/12/微信小程序跨页面通信解决思路/">微信小程序跨页面通信解决思路</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>来源：<a href="https://aotu.io/notes/2017/01/19/wxapp-event/?o2src=juejin&amp;o2layout=compat" target="_blank" rel="external">https://aotu.io/notes/2017/01/19/wxapp-event/?o2src=juejin&amp;o2layout=compat</a></p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div></pre></td><td class="code"><pre><div class="line"><span class="comment">//event.js</span></div><div class="line"><span class="class"><span class="keyword">class</span> <span class="title">Event</span> </span>&#123;</div><div class="line">    on (event, fn, ctx) &#123;</div><div class="line">        <span class="keyword">if</span> (<span class="keyword">typeof</span> fn != <span class="string">"function"</span>) &#123;</div><div class="line">            <span class="built_in">console</span>.error(<span class="string">'fn must be a function'</span>)</div><div class="line">            <span class="keyword">return</span></div><div class="line">        &#125;</div><div class="line">        </div><div class="line">        <span class="keyword">this</span>._stores = <span class="keyword">this</span>._stores || &#123;&#125;</div><div class="line">        </div><div class="line">        ;(<span class="keyword">this</span>._stores[event] = <span class="keyword">this</span>._stores[event] || []).push(&#123;<span class="attr">cb</span>: fn, <span class="attr">ctx</span>: ctx&#125;)</div><div class="line">    &#125;</div><div class="line">    emit (event) &#123;</div><div class="line">        <span class="keyword">this</span>._stores = <span class="keyword">this</span>._stores || &#123;&#125;</div><div class="line">        <span class="keyword">var</span> store = <span class="keyword">this</span>._stores[event], args</div><div class="line">        <span class="keyword">if</span> (store) &#123;</div><div class="line">            store = store.slice(<span class="number">0</span>)</div><div class="line">            args = [].slice.call(<span class="built_in">arguments</span>, <span class="number">1</span>)</div><div class="line">            <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, len = store.length; i &lt; len; i++) &#123;</div><div class="line">                store[i].cb.apply(store[i].ctx, args)</div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    off (event, fn) &#123;</div><div class="line">        <span class="keyword">this</span>._stores = <span class="keyword">this</span>._stores || &#123;&#125;</div><div class="line">        <span class="comment">// all</span></div><div class="line">        <span class="keyword">if</span> (!<span class="built_in">arguments</span>.length) &#123;</div><div class="line">            <span class="keyword">this</span>._stores = &#123;&#125;</div><div class="line">            <span class="keyword">return</span></div><div class="line">        &#125;</div><div class="line">        <span class="comment">// specific event</span></div><div class="line">        <span class="keyword">var</span> store = <span class="keyword">this</span>._stores[event]</div><div class="line">        <span class="keyword">if</span> (!store) <span class="keyword">return</span></div><div class="line">        <span class="comment">// remove all handlers</span></div><div class="line">        <span class="keyword">if</span> (<span class="built_in">arguments</span>.length === <span class="number">1</span>) &#123;</div><div class="line">            <span class="keyword">delete</span> <span class="keyword">this</span>._stores[event]</div><div class="line">            <span class="keyword">return</span> </div><div class="line">        &#125;</div><div class="line">        <span class="comment">// remove specific handler</span></div><div class="line">        <span class="keyword">var</span> cb</div><div class="line">        <span class="keyword">for</span> (<span class="keyword">var</span> i = <span class="number">0</span>, len = store.length; i &lt; len; i++) &#123;</div><div class="line">            cb = store[i].cb</div><div class="line">            <span class="keyword">if</span> (cb === fn) &#123;</div><div class="line">                store.splice(i, <span class="number">1</span>)</div><div class="line">                <span class="keyword">break</span></div><div class="line">            &#125;</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span></div><div class="line">    &#125;   </div><div class="line">&#125;</div></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://github.com/pavelShen/2017/08/12/微信小程序跨页面通信解决思路/" data-id="cj77t6lb7001j7vvgnrwu6ayv" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-javascript设计模式学习-01" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/08/05/javascript设计模式学习-01/" class="article-date">
  <time datetime="2017-08-05T09:13:35.000Z" itemprop="datePublished">2017-08-05</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/08/05/javascript设计模式学习-01/">javascript设计模式学习-01</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <p>原文：<a href="http://www.cnblogs.com/tugenhua0707/p/5198407.html" target="_blank" rel="external">http://www.cnblogs.com/tugenhua0707/p/5198407.html</a></p>
<h2 id="工场模式"><a href="#工场模式" class="headerlink" title="工场模式"></a>工场模式</h2><p>类的继承<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div><div class="line">60</div><div class="line">61</div><div class="line">62</div><div class="line">63</div><div class="line">64</div><div class="line">65</div><div class="line">66</div><div class="line">67</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 定义自行车的构造函数</span></div><div class="line"><span class="keyword">var</span> BicycleShop = <span class="function"><span class="keyword">function</span>(<span class="params">name</span>)</span>&#123;</div><div class="line">    <span class="keyword">this</span>.name = name;</div><div class="line">    <span class="keyword">this</span>.method = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.name;</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line">BicycleShop.prototype = &#123;</div><div class="line">    <span class="attr">constructor</span>: BicycleShop,</div><div class="line">    <span class="comment">/*</span></div><div class="line">     * 买自行车这个方法</div><div class="line">     * @param &#123;model&#125; 自行车型号</div><div class="line">    */</div><div class="line">    sellBicycle: <span class="function"><span class="keyword">function</span>(<span class="params">model</span>)</span>&#123;</div><div class="line">            <span class="keyword">var</span> bicycle = <span class="keyword">this</span>.createBicycle(model);</div><div class="line">            <span class="comment">// 执行A业务逻辑</span></div><div class="line">            bicycle.A();</div><div class="line">            <span class="comment">// 执行B业务逻辑</span></div><div class="line">            bicycle.B();</div><div class="line">            <span class="keyword">return</span> bicycle;</div><div class="line">        &#125;,</div><div class="line">        <span class="attr">createBicycle</span>: <span class="function"><span class="keyword">function</span>(<span class="params">model</span>)</span>&#123;</div><div class="line">            <span class="keyword">throw</span> <span class="keyword">new</span> <span class="built_in">Error</span>(<span class="string">"父类是抽象类不能直接调用，需要子类重写该方法"</span>);</div><div class="line">        &#125;</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// 实现原型继承</span></div><div class="line">    <span class="function"><span class="keyword">function</span> <span class="title">extend</span>(<span class="params">Sub,Sup</span>) </span>&#123;</div><div class="line">        <span class="comment">//Sub表示子类，Sup表示超类</span></div><div class="line">        <span class="comment">// 首先定义一个空函数</span></div><div class="line">        <span class="keyword">var</span> F = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;&#125;;</div><div class="line">        <span class="comment">// 设置空函数的原型为超类的原型</span></div><div class="line">        F.prototype = Sup.prototype; </div><div class="line">        <span class="comment">// 实例化空函数，并把超类原型引用传递给子类</span></div><div class="line">        Sub.prototype = <span class="keyword">new</span> F();</div><div class="line"></div><div class="line">        <span class="comment">// 重置子类原型的构造器为子类自身</span></div><div class="line">        Sub.prototype.constructor = Sub;</div><div class="line"></div><div class="line">        <span class="comment">// 在子类中保存超类的原型,避免子类与超类耦合</span></div><div class="line">        Sub.sup = Sup.prototype;</div><div class="line">        <span class="keyword">if</span>(Sup.prototype.constructor === <span class="built_in">Object</span>.prototype.constructor) &#123;</div><div class="line">            <span class="comment">// 检测超类原型的构造器是否为原型自身</span></div><div class="line">            Sup.prototype.constructor = Sup;</div><div class="line">        &#125;</div><div class="line">    &#125;</div><div class="line">    <span class="keyword">var</span> BicycleChild = <span class="function"><span class="keyword">function</span>(<span class="params">name</span>)</span>&#123;</div><div class="line">        <span class="keyword">this</span>.name = name;</div><div class="line"><span class="comment">// 继承构造函数父类中的属性和方法</span></div><div class="line">        BicycleShop.call(<span class="keyword">this</span>,name);</div><div class="line">    &#125;;</div><div class="line">    <span class="comment">// 子类继承父类原型方法</span></div><div class="line">    extend(BicycleChild,BicycleShop);</div><div class="line"><span class="comment">// BicycleChild 子类重写父类的方法</span></div><div class="line">BicycleChild.prototype.createBicycle = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> A = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">"执行A业务操作"</span>);    </div><div class="line">    &#125;;</div><div class="line">    <span class="keyword">var</span> B = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="built_in">console</span>.log(<span class="string">"执行B业务操作"</span>);</div><div class="line">    &#125;;</div><div class="line">    <span class="keyword">return</span> &#123;</div><div class="line">        <span class="attr">A</span>: A,</div><div class="line">        <span class="attr">B</span>: B</div><div class="line">    &#125;</div><div class="line">&#125;</div><div class="line"><span class="keyword">var</span> childClass = <span class="keyword">new</span> BicycleChild(<span class="string">"龙恩"</span>);</div><div class="line"><span class="built_in">console</span>.log(childClass);</div></pre></td></tr></table></figure></p>
<h2 id="单例模式"><a href="#单例模式" class="headerlink" title="单例模式"></a>单例模式</h2><p>比如我现在页面上需要创建一个div的元素，那么我们肯定需要有一个创建div的函数，而现在我只需要这个函数只负责创建div元素，其他的它不想管，也就是想实现单一职责原则</p>
<figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 单体模式</span></div><div class="line"><span class="keyword">var</span> Singleton = <span class="function"><span class="keyword">function</span>(<span class="params">name</span>)</span>&#123;</div><div class="line">    <span class="keyword">this</span>.name = name;</div><div class="line">&#125;;</div><div class="line">Singleton.prototype.getName = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">this</span>.name;</div><div class="line">&#125;</div><div class="line"><span class="comment">// 获取实例对象</span></div><div class="line"><span class="keyword">var</span> getInstance = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> instance = <span class="literal">null</span>;</div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params">name</span>) </span>&#123;</div><div class="line">        <span class="keyword">if</span>(!instance) &#123;</div><div class="line">            instance = <span class="keyword">new</span> Singleton(name);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> instance;</div><div class="line">    &#125;</div><div class="line">&#125;)();</div><div class="line"><span class="comment">// 测试单体模式的实例</span></div><div class="line"><span class="keyword">var</span> a = getInstance(<span class="string">"aa"</span>);</div><div class="line"><span class="keyword">var</span> b = getInstance(<span class="string">"bb"</span>);</div></pre></td></tr></table></figure>
<p>防止重复生成弹窗实例（减少重绘，提升性能）<br>例子：<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 实现单体模式弹窗</span></div><div class="line"><span class="keyword">var</span> createWindow = (<span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> div;</div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="keyword">if</span>(!div) &#123;</div><div class="line">            div = <span class="built_in">document</span>.createElement(<span class="string">"div"</span>);</div><div class="line">            div.innerHTML = <span class="string">"我是弹窗内容"</span>;</div><div class="line">            div.style.display = <span class="string">'none'</span>;</div><div class="line">            <span class="built_in">document</span>.body.appendChild(div);</div><div class="line">        &#125;</div><div class="line">        <span class="keyword">return</span> div;</div><div class="line">    &#125;</div><div class="line">&#125;)();</div><div class="line"><span class="built_in">document</span>.getElementById(<span class="string">"Id"</span>).onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="comment">// 点击后先创建一个div元素</span></div><div class="line">    <span class="keyword">var</span> win = createWindow();</div><div class="line">    win.style.display = <span class="string">"block"</span>;</div><div class="line">&#125;</div></pre></td></tr></table></figure></p>
<p>封装<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// 创建div</span></div><div class="line"><span class="keyword">var</span> createWindow = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> div = <span class="built_in">document</span>.createElement(<span class="string">"div"</span>);</div><div class="line">    div.innerHTML = <span class="string">"我是弹窗内容"</span>;</div><div class="line">    div.style.display = <span class="string">'none'</span>;</div><div class="line">    <span class="built_in">document</span>.body.appendChild(div);</div><div class="line">    <span class="keyword">return</span> div;</div><div class="line">&#125;;</div><div class="line"><span class="comment">// 创建iframe</span></div><div class="line"><span class="keyword">var</span> createIframe = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> iframe = <span class="built_in">document</span>.createElement(<span class="string">"iframe"</span>);</div><div class="line">    <span class="built_in">document</span>.body.appendChild(iframe);</div><div class="line">    <span class="keyword">return</span> iframe;</div><div class="line">&#125;;</div><div class="line"><span class="comment">// 获取实例的封装代码</span></div><div class="line"><span class="keyword">var</span> getInstance = <span class="function"><span class="keyword">function</span>(<span class="params">fn</span>) </span>&#123;</div><div class="line">    <span class="keyword">var</span> result;</div><div class="line">    <span class="keyword">return</span> <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">        <span class="keyword">return</span> result || (result = fn.call(<span class="keyword">this</span>,<span class="built_in">arguments</span>));</div><div class="line">    &#125;</div><div class="line">&#125;;</div><div class="line"><span class="comment">// 测试创建div</span></div><div class="line"><span class="keyword">var</span> createSingleDiv = getInstance(createWindow);</div><div class="line"><span class="built_in">document</span>.getElementById(<span class="string">"Id"</span>).onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> win = createSingleDiv();</div><div class="line">    win.style.display = <span class="string">"block"</span>;</div><div class="line">&#125;;</div><div class="line"><span class="comment">// 测试创建iframe</span></div><div class="line"><span class="keyword">var</span> createSingleIframe = getInstance(createIframe);</div><div class="line"><span class="built_in">document</span>.getElementById(<span class="string">"Id"</span>).onclick = <span class="function"><span class="keyword">function</span>(<span class="params"></span>)</span>&#123;</div><div class="line">    <span class="keyword">var</span> win = createSingleIframe();</div><div class="line">    win.src = <span class="string">"http://cnblogs.com"</span>;</div><div class="line">&#125;;</div></pre></td></tr></table></figure></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://github.com/pavelShen/2017/08/05/javascript设计模式学习-01/" data-id="cj77t6lar000y7vvgfm0lndwm" class="article-share-link">Share</a>
      
      
    </footer>
  </div>
  
</article>



  
    <article id="post-canvas学习总结" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/07/17/canvas学习总结/" class="article-date">
  <time datetime="2017-07-17T06:12:29.000Z" itemprop="datePublished">2017-07-17</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/07/17/canvas学习总结/">canvas学习总结</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="常用API"><a href="#常用API" class="headerlink" title="常用API"></a>常用API</h2><p><code>ctx = canvas.getContext(‘2d’)</code> 获取上下文<br><code>ctx.canvas.height ctx.canvas.width</code> 获取画布宽高<br><code>beginPath()</code> 清空子路径列表开始一个新路径的方法<br><code>closePath()</code> 将笔点返回到当前子路径起始点的方法。它尝试从当前点到起始点绘制一条直线。 如果图形已经是封闭的或者只有一个点，那么此方法不会做任何操作<br><code>globalCompositeOperation = type</code>   我们不仅可以在已有图形后面再画新图形，还可以用来遮盖指定区域，清除画布中的某些部分（清除区域不仅限于矩形，像clearRect()方法做的那样 ）以及更多其他操作。</p>
<h4 id="状态快照"><a href="#状态快照" class="headerlink" title="状态快照"></a>状态快照</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">save()</div><div class="line">restore()</div></pre></td></tr></table></figure>
<p>save 和 restore 方法是用来保存和恢复 canvas 状态的，都没有参数。Canvas 的状态就是当前画面应用的所有样式和变形的一个快照。<br>Canvas状态存储在栈中，每当save()方法被调用后，当前的状态就被推送到栈中保存。一个绘画状态包括：</p>
<ul>
<li>当前应用的变形（即移动，旋转和缩放，见下）</li>
<li>strokeStyle, fillStyle, globalAlpha, lineWidth, lineCap, lineJoin, miterLimit, shadowOffsetX, shadowOffsetY, shadowBlur, shadowColor, globalCompositeOperation 的值</li>
<li>当前的裁切路径（clipping path）</li>
</ul>
<p>你可以调用任意多次 save 方法。<br>每一次调用 restore 方法，上一个保存的状态就从栈中弹出，所有设定都恢复。</p>
<h4 id="tip"><a href="#tip" class="headerlink" title="tip:"></a>tip:</h4><ul>
<li>调用beginPath()之后（或者canvas刚建的时候）第一条路径构造命令通常被视为是moveTo，所以这里最好使用moveTo命令显示声明起始点</li>
<li>当你调用fill()函数时，所有没有闭合的形状都会自动闭合，所以你不需要调用closePath()函数。但是调用stroke()时不会自动闭合。</li>
</ul>
<hr>
<h2 id="绘画步骤"><a href="#绘画步骤" class="headerlink" title="绘画步骤"></a>绘画步骤</h2><h4 id="路径绘制"><a href="#路径绘制" class="headerlink" title="路径绘制"></a>路径绘制</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div></pre></td><td class="code"><pre><div class="line">rect(x, y, width, height)</div><div class="line">arc(x, y, radius, startAngle, endAngle, anticlockwise)</div><div class="line">lineTo(x,y)</div><div class="line"></div><div class="line"><span class="keyword">var</span> rectangle = <span class="keyword">new</span> Path2D();  <span class="comment">// 将某一个路径作为变量——创建一个它的副本</span></div><div class="line">rectangle.rect(<span class="number">10</span>, <span class="number">10</span>, <span class="number">50</span>, <span class="number">50</span>);</div><div class="line">ctx.stroke(rectangle);</div></pre></td></tr></table></figure>
<h4 id="设置样式"><a href="#设置样式" class="headerlink" title="设置样式"></a>设置样式</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div></pre></td><td class="code"><pre><div class="line"><span class="comment">// color  DOMString 字符串，可以转换成 CSS &lt;color&gt; 值。</span></div><div class="line"><span class="comment">// gradient  CanvasGradient 对象（线性渐变或放射性渐变）。</span></div><div class="line"><span class="comment">// pattern   CanvasPattern 对象（可重复的图片）。</span></div><div class="line">ctx.fillStyle = color;</div><div class="line">ctx.fillStyle = gradient;</div><div class="line">ctx.fillStyle = pattern;</div><div class="line"></div><div class="line"><span class="comment">//strokeStyle 参考fillStyle</span></div></pre></td></tr></table></figure>
<p>最后通过 <code>ctx.fill()</code> 或者 <code>ctx.stroke()</code>进行绘制</p>
<hr>
<h2 id="图片"><a href="#图片" class="headerlink" title="图片"></a>图片</h2><h4 id="引入图像到canvas里需要以下两步基本操作："><a href="#引入图像到canvas里需要以下两步基本操作：" class="headerlink" title="引入图像到canvas里需要以下两步基本操作："></a>引入图像到canvas里需要以下两步基本操作：</h4><ol>
<li>获得一个指向HTMLImageElement的对象或者另一个canvas元素的引用作为源，也可以通过提供一个URL的方式来使用图片</li>
<li>使用drawImage()函数将图片绘制到画布上</li>
</ol>
<h4 id="drawImage"><a href="#drawImage" class="headerlink" title="drawImage"></a>drawImage</h4><ul>
<li>绘制<br>drawImage(image, x, y) 其中 image 是 image 或者 canvas 对象，x 和 y 是其在目标 canvas 里的起始坐标。</li>
<li>缩放<br>drawImage(image, x, y, width, height) 这个方法多了2个参数：width 和 height，这两个参数用来控制 当像canvas画入时应该缩放的大小</li>
<li>切片<br>drawImage(image, sx, sy, sWidth, sHeight, dx, dy, dWidth, dHeight)<br>第一个参数和其它的是相同的，都是一个图像或者另一个 canvas 的引用。其它8个参数最好是参照右边的图解，前4个是定义图像源的切片位置和大小，后4个则是定义切片的目标显示位置和大小。</li>
</ul>
<h4 id="源"><a href="#源" class="headerlink" title="源"></a>源</h4><ul>
<li>HTMLImageElement 这些图片是由Image()函数构造出来的，或者任何的<code>&lt;img&gt;</code>元素</li>
<li>HTMLVideoElement 用一个HTML的 <code>&lt;video&gt;</code>元素作为你的图片源，可以从视频中抓取当前帧作为一个图像</li>
<li>HTMLCanvasElement 可以使用另一个 <code>&lt;canvas&gt;</code> 元素作为你的图片源。</li>
<li>ImageBitmap 这是一个高性能的位图，可以低延迟地绘制，它可以从上述的所有源以及其它几种源中生成。</li>
</ul>
<h4 id="使用其它域名下的图片"><a href="#使用其它域名下的图片" class="headerlink" title="使用其它域名下的图片"></a>使用其它域名下的图片</h4><p>在 HTMLImageElement上使用crossOrigin属性，你可以请求加载其它域名上的图片。如果图片的服务器允许跨域访问这个图片，那么你可以使用这个图片而不污染canvas，否则，使用这个图片将会污染canvas。<br>示例代码<br><figure class="highlight"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div></pre></td><td class="code"><pre><div class="line">&lt;img src="http://n1image.hjfile.cn/mh/2016/09/02/a0c9ca472e8ae8e26e34a31d98c074ce.jpg" id="a" crossorigin="anonymous"&gt;&lt;/img&gt;</div><div class="line">&lt;canvas id="myCanvas" width="500" height="550" style="border:1px solid #d3d3d3;"&gt;&lt;/canvas&gt;</div><div class="line">&lt;script&gt;</div><div class="line">var c=document.getElementById("myCanvas");</div><div class="line">var ctx=c.getContext("2d");</div><div class="line">var img = document.getElementById('a')</div><div class="line">img.onload = function()&#123;</div><div class="line">  ctx.drawImage(img,0,0)</div><div class="line">&#125;</div><div class="line">function copy()</div><div class="line">&#123;</div><div class="line">var imgData=ctx.getImageData(20,20,150,150);</div><div class="line">ctx.putImageData(imgData,150,70);</div><div class="line">&#125;</div><div class="line">&lt;/script&gt;</div><div class="line">&lt;button onclick="copy()"&gt;复制&lt;/button&gt;</div></pre></td></tr></table></figure></p>
<h4 id="设置crossOrigin属性"><a href="#设置crossOrigin属性" class="headerlink" title="设置crossOrigin属性"></a>设置crossOrigin属性</h4><p>在HTML5中，一些 HTML 元素提供了对 CORS 的支持， 例如 <code>&lt;img&gt;</code> 和 <code>&lt;video&gt;</code> 均有一个跨域属性 (crossOrigin property)，它允许你配置元素获取数据的 CORS 请求。<br>可选值：</p>
<ul>
<li>anonymous 对此元素的CORS请求将不设置凭据标志。</li>
<li>use-credentials 对此元素的CORS请求将设置凭证标志; 这意味着请求将提供凭据。<br>无效的关键字和空字符串也会被当作 anonymous 关键字使用<br>示例<br><code>&lt;script src=&quot;https://example.com/example-framework.js&quot; crossorigin=&quot;anonymous&quot;&gt;&lt;/script&gt;</code></li>
</ul>
<h4 id="污染canvas"><a href="#污染canvas" class="headerlink" title="污染canvas"></a>污染canvas</h4><p>尽管不通过 CORS 就可以在画布中使用图片，但是这会污染画布。一旦画布被污染，你就无法读取其数据。例如，你不能再使用画布的 toBlob(), toDataURL() 或 getImageData() 方法，调用它们会抛出安全错误。<br>这种机制可以避免未经许可拉取远程网站信息而导致的用户隐私泄露。</p>
<h4 id="使用其它-canvas-元素"><a href="#使用其它-canvas-元素" class="headerlink" title="使用其它 canvas 元素"></a>使用其它 canvas 元素</h4><p>和引用页面内的图片类似地，用 document.getElementsByTagName 或 document.getElementById 方法来获取其它 canvas 元素。但你引入的应该是已经准备好的 canvas。<br><strong>一个常用的应用就是将第二个canvas作为另一个大的 canvas 的缩略图。</strong></p>
<hr>
<h2 id="像素操作"><a href="#像素操作" class="headerlink" title="像素操作"></a>像素操作</h2><h4 id="ImageData-对象"><a href="#ImageData-对象" class="headerlink" title="ImageData 对象"></a>ImageData 对象</h4><p><strong>ImageData对象中存储着canvas对象真实的像素数据，它包含以下几个只读属性：</strong></p>
<ul>
<li>width 图片宽度，单位是像素</li>
<li>height 图片高度，单位是像素</li>
<li>data<br>Uint8ClampedArray类型的一维数组，包含着RGBA格式的整型数据，范围在0至255之间（包括255）。<br>data属性返回一个 Uint8ClampedArray，它可以被使用作为查看初始像素数据。每个像素用4个1bytes值(按照红，绿，蓝和透明值的顺序; 这就是”RGBA”格式) 来代表。每个颜色值部份用0至255来代表。每个部份被分配到一个在数组内连续的索引，左上角像素的红色部份在数组的索引0位置。像素从左到右被处理，然后往下，遍历整个数组。</li>
</ul>
<h4 id="得到场景像素数据"><a href="#得到场景像素数据" class="headerlink" title="得到场景像素数据"></a>得到场景像素数据</h4><p><code>var myImageData = ctx.getImageData(left, top, width, height);</code><br>注：任何在画布以外的元素都会被返回成一个透明黑的ImageData对像。</p>
<h4 id="demo取色器"><a href="#demo取色器" class="headerlink" title="demo取色器"></a>demo取色器</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> img = <span class="keyword">new</span> Image();</div><div class="line">img.src = <span class="string">'https://mdn.mozillademos.org/files/5397/rhino.jpg'</span>;</div><div class="line"><span class="keyword">var</span> canvas = <span class="built_in">document</span>.getElementById(<span class="string">'canvas'</span>);</div><div class="line"><span class="keyword">var</span> ctx = canvas.getContext(<span class="string">'2d'</span>);</div><div class="line">img.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  ctx.drawImage(img, <span class="number">0</span>, <span class="number">0</span>);</div><div class="line">  img.style.display = <span class="string">'none'</span>;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">var</span> color = <span class="built_in">document</span>.getElementById(<span class="string">'color'</span>);</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">pick</span>(<span class="params">event</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> x = event.layerX;</div><div class="line">  <span class="keyword">var</span> y = event.layerY;</div><div class="line">  <span class="keyword">var</span> pixel = ctx.getImageData(x, y, <span class="number">1</span>, <span class="number">1</span>);</div><div class="line">  <span class="keyword">var</span> data = pixel.data;</div><div class="line">  <span class="keyword">var</span> rgba = <span class="string">'rgba('</span> + data[<span class="number">0</span>] + <span class="string">','</span> + data[<span class="number">1</span>] +</div><div class="line">             <span class="string">','</span> + data[<span class="number">2</span>] + <span class="string">','</span> + (data[<span class="number">3</span>] / <span class="number">255</span>) + <span class="string">')'</span>;</div><div class="line">  color.style.background = rgba;</div><div class="line">  color.textContent = rgba;</div><div class="line">&#125;</div><div class="line">canvas.addEventListener(<span class="string">'mousemove'</span>, pick);</div></pre></td></tr></table></figure>
<h4 id="在场景中写入像素数据"><a href="#在场景中写入像素数据" class="headerlink" title="在场景中写入像素数据"></a>在场景中写入像素数据</h4><p><code>ctx.putImageData(myImageData, dx, dy);</code> dx和dy参数表示你希望在场景内左上角绘制的像素数据所得到的设备坐标。</p>
<h4 id="保存图片"><a href="#保存图片" class="headerlink" title="保存图片"></a>保存图片</h4><ul>
<li>canvas.toDataURL(‘image/png’) 默认设定。</li>
<li>canvas.toDataURL(‘image/jpeg’, quality)<br>创建一个JPG图片。你可以有选择地提供从0到1的品质量，1表示最好品质，0基本不被辨析但有比较小的文件大小。</li>
</ul>
<hr>
<h2 id="其他"><a href="#其他" class="headerlink" title="其他"></a>其他</h2><h4 id="线条"><a href="#线条" class="headerlink" title="线条"></a>线条</h4><p>宽度为奇数的线并不能精确呈现，这就是因为路径的定位问题<br><img src="https://mdn.mozillademos.org/files/201/canvas-grid.png" alt="图片" title="title"></p>
<h4 id="clip裁切"><a href="#clip裁切" class="headerlink" title="clip裁切"></a>clip裁切</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div></pre></td><td class="code"><pre><div class="line">ctx.beginPath();</div><div class="line">ctx.arc(<span class="number">0</span>,<span class="number">0</span>,<span class="number">60</span>,<span class="number">0</span>,<span class="built_in">Math</span>.PI*<span class="number">2</span>,<span class="literal">true</span>);</div><div class="line">ctx.clip();</div></pre></td></tr></table></figure>
<p>裁切路径不会在 canvas 上绘制东西，而且它永远不受新图形的影响。这些特性使得它在特定区域里绘制图形时相当好用。( 可以把它理解成PS里面的选择工具 )<br><strong>裁切区域需要通过save&amp;restore方法去还原，因为是路径方法，所以要记得beginPath</strong></p>
<h2 id="相关文档"><a href="#相关文档" class="headerlink" title="相关文档"></a>相关文档</h2><p>MDN:<a href="https://developer.mozilla.org/zh-CN/docs/Web/API/Canvas_API/Tutorial" target="_blank" rel="external">https://developer.mozilla.org/zh-CN/docs/Web/API/Canvas_API/Tutorial</a><br>canvas动画：<a href="http://www.zhangxinxu.com/wordpress/2017/03/canvas-2d-cool-affect-skills-technology/" target="_blank" rel="external">http://www.zhangxinxu.com/wordpress/2017/03/canvas-2d-cool-affect-skills-technology/</a><br>canvas圆角：<a href="http://www.zhangxinxu.com/wordpress/2014/06/svg-canvas-image-border-radius/" target="_blank" rel="external">http://www.zhangxinxu.com/wordpress/2014/06/svg-canvas-image-border-radius/</a></p>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://github.com/pavelShen/2017/07/17/canvas学习总结/" data-id="cj77t6l9l00017vvg9x6to4no" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/canvas/">canvas</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-canvas链式操作" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/07/11/canvas链式操作/" class="article-date">
  <time datetime="2017-07-11T06:45:04.000Z" itemprop="datePublished">2017-07-11</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/07/11/canvas链式操作/">canvas链式操作</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="链式操作"><a href="#链式操作" class="headerlink" title="链式操作"></a>链式操作</h2><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div><div class="line">47</div><div class="line">48</div><div class="line">49</div><div class="line">50</div><div class="line">51</div><div class="line">52</div><div class="line">53</div><div class="line">54</div><div class="line">55</div><div class="line">56</div><div class="line">57</div><div class="line">58</div><div class="line">59</div></pre></td><td class="code"><pre><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">Canvas2DContext</span>(<span class="params">canvas</span>) </span>&#123;</div><div class="line">  <span class="keyword">if</span> (<span class="keyword">typeof</span> canvas === <span class="string">'string'</span>) &#123;</div><div class="line">    canvas = <span class="built_in">document</span>.getElementById(canvas);</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">if</span> (!(<span class="keyword">this</span> <span class="keyword">instanceof</span> Canvas2DContext)) &#123;</div><div class="line">    <span class="keyword">return</span> <span class="keyword">new</span> Canvas2DContext(canvas);</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">this</span>.context = <span class="keyword">this</span>.ctx = canvas.getContext(<span class="string">'2d'</span>);</div><div class="line">  <span class="keyword">if</span> (!Canvas2DContext.prototype.arc) &#123;</div><div class="line">    Canvas2DContext.setup.call(<span class="keyword">this</span>, <span class="keyword">this</span>.ctx);</div><div class="line">  &#125;</div><div class="line">&#125;</div><div class="line">Canvas2DContext.setup = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> methods = [<span class="string">'arc'</span>, <span class="string">'arcTo'</span>, <span class="string">'beginPath'</span>, <span class="string">'bezierCurveTo'</span>, <span class="string">'clearRect'</span>, <span class="string">'clip'</span>,</div><div class="line">    <span class="string">'closePath'</span>, <span class="string">'drawImage'</span>, <span class="string">'fill'</span>, <span class="string">'fillRect'</span>, <span class="string">'fillText'</span>, <span class="string">'lineTo'</span>, <span class="string">'moveTo'</span>,</div><div class="line">    <span class="string">'quadraticCurveTo'</span>, <span class="string">'rect'</span>, <span class="string">'restore'</span>, <span class="string">'rotate'</span>, <span class="string">'save'</span>, <span class="string">'scale'</span>, <span class="string">'setTransform'</span>,</div><div class="line">    <span class="string">'stroke'</span>, <span class="string">'strokeRect'</span>, <span class="string">'strokeText'</span>, <span class="string">'transform'</span>, <span class="string">'translate'</span>];</div><div class="line">  <span class="keyword">var</span> getterMethods = [<span class="string">'createPattern'</span>, <span class="string">'drawFocusRing'</span>, <span class="string">'isPointInPath'</span>, <span class="string">'measureText'</span>, <span class="comment">// drawFocusRing not currently supported</span></div><div class="line">    <span class="comment">// The following might instead be wrapped to be able to chain their child objects</span></div><div class="line">    <span class="string">'createImageData'</span>, <span class="string">'createLinearGradient'</span>,</div><div class="line">    <span class="string">'createRadialGradient'</span>, <span class="string">'getImageData'</span>, <span class="string">'putImageData'</span></div><div class="line">  ];</div><div class="line">  <span class="keyword">var</span> props = [<span class="string">'canvas'</span>, <span class="string">'fillStyle'</span>, <span class="string">'font'</span>, <span class="string">'globalAlpha'</span>, <span class="string">'globalCompositeOperation'</span>,</div><div class="line">    <span class="string">'lineCap'</span>, <span class="string">'lineJoin'</span>, <span class="string">'lineWidth'</span>, <span class="string">'miterLimit'</span>, <span class="string">'shadowOffsetX'</span>, <span class="string">'shadowOffsetY'</span>,</div><div class="line">    <span class="string">'shadowBlur'</span>, <span class="string">'shadowColor'</span>, <span class="string">'strokeStyle'</span>, <span class="string">'textAlign'</span>, <span class="string">'textBaseline'</span>];</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> m <span class="keyword">of</span> methods) &#123;</div><div class="line">    <span class="keyword">let</span> method = m;</div><div class="line">    Canvas2DContext.prototype[method] = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">      <span class="keyword">this</span>.ctx[method].apply(<span class="keyword">this</span>.ctx, <span class="built_in">arguments</span>);</div><div class="line">      <span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">    &#125;;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> m <span class="keyword">of</span> getterMethods) &#123;</div><div class="line">    <span class="keyword">let</span> method = m;</div><div class="line">    Canvas2DContext.prototype[method] = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">      <span class="keyword">return</span> <span class="keyword">this</span>.ctx[method].apply(<span class="keyword">this</span>.ctx, <span class="built_in">arguments</span>);</div><div class="line">    &#125;;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">for</span> (<span class="keyword">let</span> p <span class="keyword">of</span> props) &#123;</div><div class="line">    <span class="keyword">let</span> prop = p;</div><div class="line">    Canvas2DContext.prototype[prop] = <span class="function"><span class="keyword">function</span>(<span class="params">value</span>) </span>&#123;</div><div class="line">      <span class="keyword">if</span> (value === <span class="literal">undefined</span>)</div><div class="line">        <span class="keyword">return</span> <span class="keyword">this</span>.ctx[prop];</div><div class="line">      <span class="keyword">this</span>.ctx[prop] = value;</div><div class="line">      <span class="keyword">return</span> <span class="keyword">this</span>;</div><div class="line">    &#125;;</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">var</span> canvas = <span class="built_in">document</span>.getElementById(<span class="string">'canvas'</span>);</div><div class="line"><span class="comment">// Use context to get access to underlying context</span></div><div class="line"><span class="keyword">var</span> ctx = Canvas2DContext(canvas)</div><div class="line">  .strokeStyle(<span class="string">'rgb(30, 110, 210)'</span>)</div><div class="line">  .transform(<span class="number">10</span>, <span class="number">3</span>, <span class="number">4</span>, <span class="number">5</span>, <span class="number">1</span>, <span class="number">0</span>)</div><div class="line">  .strokeRect(<span class="number">2</span>, <span class="number">10</span>, <span class="number">15</span>, <span class="number">20</span>)</div><div class="line">  .context;</div><div class="line"><span class="comment">// Use property name as a function (but without arguments) to get the value</span></div><div class="line"><span class="keyword">var</span> strokeStyle = Canvas2DContext(canvas)</div><div class="line">  .strokeStyle(<span class="string">'rgb(50, 110, 210)'</span>)</div><div class="line">  .strokeStyle();</div></pre></td></tr></table></figure>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://github.com/pavelShen/2017/07/11/canvas链式操作/" data-id="cj77t6lab000h7vvgvrza2ov0" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/canvas/">canvas</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-canvas学习笔记-API（07）" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/07/11/canvas学习笔记-API（07）/" class="article-date">
  <time datetime="2017-07-11T06:27:50.000Z" itemprop="datePublished">2017-07-11</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/07/11/canvas学习笔记-API（07）/">canvas学习笔记 - API（07）</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="像素操作"><a href="#像素操作" class="headerlink" title="像素操作"></a>像素操作</h2><h4 id="ImageData-对象"><a href="#ImageData-对象" class="headerlink" title="ImageData 对象"></a>ImageData 对象</h4><p><strong>ImageData对象中存储着canvas对象真实的像素数据，它包含以下几个只读属性：</strong></p>
<ul>
<li>width 图片宽度，单位是像素</li>
<li>height 图片高度，单位是像素</li>
<li>data<br>Uint8ClampedArray类型的一维数组，包含着RGBA格式的整型数据，范围在0至255之间（包括255）。<br>data属性返回一个 Uint8ClampedArray，它可以被使用作为查看初始像素数据。每个像素用4个1bytes值(按照红，绿，蓝和透明值的顺序; 这就是”RGBA”格式) 来代表。每个颜色值部份用0至255来代表。每个部份被分配到一个在数组内连续的索引，左上角像素的红色部份在数组的索引0位置。像素从左到右被处理，然后往下，遍历整个数组。</li>
</ul>
<h4 id="创建一个ImageData对象"><a href="#创建一个ImageData对象" class="headerlink" title="创建一个ImageData对象"></a>创建一个ImageData对象</h4><p>去创建一个新的，空白的ImageData对象，你应该会使用createImageData() 方法。有2个版本的createImageData()方法。</p>
<ol>
<li><p><code>var myImageData = ctx.createImageData(width, height);</code><br>上面代码创建了一个新的具体特定尺寸的ImageData对象。所有像素被预设为透明黑。</p>
</li>
<li><p><code>var myImageData = ctx.createImageData(anotherImageData);</code><br>你也可以创建一个被anotherImageData对象指定的相同像素的ImageData对象。这个新的对象像素全部被预设为透明黑。这个并非复制了图片数据。</p>
</li>
</ol>
<h4 id="得到场景像素数据"><a href="#得到场景像素数据" class="headerlink" title="得到场景像素数据"></a>得到场景像素数据</h4><p><code>var myImageData = ctx.getImageData(left, top, width, height);</code><br>注：任何在画布以外的元素都会被返回成一个透明黑的ImageData对像。</p>
<h4 id="demo取色器"><a href="#demo取色器" class="headerlink" title="demo取色器"></a>demo取色器</h4><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> img = <span class="keyword">new</span> Image();</div><div class="line">img.src = <span class="string">'https://mdn.mozillademos.org/files/5397/rhino.jpg'</span>;</div><div class="line"><span class="keyword">var</span> canvas = <span class="built_in">document</span>.getElementById(<span class="string">'canvas'</span>);</div><div class="line"><span class="keyword">var</span> ctx = canvas.getContext(<span class="string">'2d'</span>);</div><div class="line">img.onload = <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  ctx.drawImage(img, <span class="number">0</span>, <span class="number">0</span>);</div><div class="line">  img.style.display = <span class="string">'none'</span>;</div><div class="line">&#125;;</div><div class="line"><span class="keyword">var</span> color = <span class="built_in">document</span>.getElementById(<span class="string">'color'</span>);</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">pick</span>(<span class="params">event</span>) </span>&#123;</div><div class="line">  <span class="keyword">var</span> x = event.layerX;</div><div class="line">  <span class="keyword">var</span> y = event.layerY;</div><div class="line">  <span class="keyword">var</span> pixel = ctx.getImageData(x, y, <span class="number">1</span>, <span class="number">1</span>);</div><div class="line">  <span class="keyword">var</span> data = pixel.data;</div><div class="line">  <span class="keyword">var</span> rgba = <span class="string">'rgba('</span> + data[<span class="number">0</span>] + <span class="string">','</span> + data[<span class="number">1</span>] +</div><div class="line">             <span class="string">','</span> + data[<span class="number">2</span>] + <span class="string">','</span> + (data[<span class="number">3</span>] / <span class="number">255</span>) + <span class="string">')'</span>;</div><div class="line">  color.style.background = rgba;</div><div class="line">  color.textContent = rgba;</div><div class="line">&#125;</div><div class="line">canvas.addEventListener(<span class="string">'mousemove'</span>, pick);</div></pre></td></tr></table></figure>
<h4 id="在场景中写入像素数据"><a href="#在场景中写入像素数据" class="headerlink" title="在场景中写入像素数据"></a>在场景中写入像素数据</h4><p><code>ctx.putImageData(myImageData, dx, dy);</code> dx和dy参数表示你希望在场景内左上角绘制的像素数据所得到的设备坐标。</p>
<h4 id="反锯齿"><a href="#反锯齿" class="headerlink" title="反锯齿"></a>反锯齿</h4><p>反锯齿默认开启，手动关闭可以看清放大后的图片的具体像素<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div></pre></td><td class="code"><pre><div class="line">zoomctx.imageSmoothingEnabled = <span class="keyword">this</span>.checked;</div><div class="line">zoomctx.mozImageSmoothingEnabled = <span class="keyword">this</span>.checked;</div><div class="line">zoomctx.webkitImageSmoothingEnabled = <span class="keyword">this</span>.checked;</div><div class="line">zoomctx.msImageSmoothingEnabled = <span class="keyword">this</span>.checked;</div></pre></td></tr></table></figure></p>
<h4 id="保存图片"><a href="#保存图片" class="headerlink" title="保存图片"></a>保存图片</h4><ul>
<li>canvas.toDataURL(‘image/png’)  默认设定。创建一个PNG图片。</li>
<li>canvas.toDataURL(‘image/jpeg’, quality)<br>创建一个JPG图片。你可以有选择地提供从0到1的品质量，1表示最好品质，0基本不被辨析但有比较小的文件大小。</li>
</ul>

      
    </div>
    <footer class="article-footer">
      <a data-url="https://github.com/pavelShen/2017/07/11/canvas学习笔记-API（07）/" data-id="cj77t6la8000f7vvgtye4rw14" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/canvas/">canvas</a></li></ul>

    </footer>
  </div>
  
</article>



  
    <article id="post-canvas学习笔记-API（06）" class="article article-type-post" itemscope itemprop="blogPost">
  <div class="article-meta">
    <a href="/2017/07/11/canvas学习笔记-API（06）/" class="article-date">
  <time datetime="2017-07-11T06:27:46.000Z" itemprop="datePublished">2017-07-11</time>
</a>
    
  </div>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 itemprop="name">
      <a class="article-title" href="/2017/07/11/canvas学习笔记-API（06）/">canvas学习笔记 - API（06）</a>
    </h1>
  

      </header>
    
    <div class="article-entry" itemprop="articleBody">
      
        <h2 id="动画"><a href="#动画" class="headerlink" title="动画"></a>动画</h2><h3 id="动画的基本"><a href="#动画的基本" class="headerlink" title="动画的基本"></a>动画的基本</h3><ul>
<li>清空 canvas<br>除非接下来要画的内容会完全充满 canvas （例如背景图），否则你需要清空所有。最简单的做法就是用 clearRect 方法。</li>
<li>保存 canvas 状态<br>如果你要改变一些会改变 canvas 状态的设置（样式，变形之类的），又要在每画一帧之时都是原始状态的话，你需要先保存一下。</li>
<li>绘制动画图形（animated shapes）<br>这一步才是重绘动画帧。</li>
<li>恢复 canvas 状态<br>如果已经保存了 canvas 的状态，可以先恢复它，然后重绘下一帧。</li>
</ul>
<h3 id="有安排的更新画布-Scheduled-updates"><a href="#有安排的更新画布-Scheduled-updates" class="headerlink" title="有安排的更新画布 Scheduled updates"></a>有安排的更新画布 Scheduled updates</h3><p>可以用window.setInterval(), window.setTimeout(),和window.requestAnimationFrame()来设定定期执行一个指定函数。</p>
<h3 id="长尾效果"><a href="#长尾效果" class="headerlink" title="长尾效果"></a>长尾效果</h3><p>直到现在，我们已经使用clearRect 函数当我们清除前一帧动画。当你用一个半透明的fillRect函数取代这个函数的时候，你可以轻松获得长尾效果。<br><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div></pre></td><td class="code"><pre><div class="line">ctx.fillStyle = <span class="string">'rgba(255,255,255,0.3)'</span>;</div><div class="line">ctx.fillRect(<span class="number">0</span>,<span class="number">0</span>,canvas.width,canvas.height);</div></pre></td></tr></table></figure></p>
<h3 id="demo"><a href="#demo" class="headerlink" title="demo"></a>demo</h3><figure class="highlight javascript"><table><tr><td class="gutter"><pre><div class="line">1</div><div class="line">2</div><div class="line">3</div><div class="line">4</div><div class="line">5</div><div class="line">6</div><div class="line">7</div><div class="line">8</div><div class="line">9</div><div class="line">10</div><div class="line">11</div><div class="line">12</div><div class="line">13</div><div class="line">14</div><div class="line">15</div><div class="line">16</div><div class="line">17</div><div class="line">18</div><div class="line">19</div><div class="line">20</div><div class="line">21</div><div class="line">22</div><div class="line">23</div><div class="line">24</div><div class="line">25</div><div class="line">26</div><div class="line">27</div><div class="line">28</div><div class="line">29</div><div class="line">30</div><div class="line">31</div><div class="line">32</div><div class="line">33</div><div class="line">34</div><div class="line">35</div><div class="line">36</div><div class="line">37</div><div class="line">38</div><div class="line">39</div><div class="line">40</div><div class="line">41</div><div class="line">42</div><div class="line">43</div><div class="line">44</div><div class="line">45</div><div class="line">46</div></pre></td><td class="code"><pre><div class="line"><span class="keyword">var</span> canvas = <span class="built_in">document</span>.getElementById(<span class="string">'canvas'</span>);</div><div class="line"><span class="keyword">var</span> ctx = canvas.getContext(<span class="string">'2d'</span>);</div><div class="line"><span class="keyword">var</span> raf;</div><div class="line"><span class="keyword">var</span> ball = &#123;</div><div class="line">  <span class="attr">x</span>: <span class="number">100</span>,</div><div class="line">  <span class="attr">y</span>: <span class="number">100</span>,</div><div class="line">  <span class="attr">vx</span>: <span class="number">5</span>,</div><div class="line">  <span class="attr">vy</span>: <span class="number">2</span>,</div><div class="line">  <span class="attr">radius</span>: <span class="number">25</span>,</div><div class="line">  <span class="attr">color</span>: <span class="string">'blue'</span>,</div><div class="line">  <span class="attr">draw</span>: <span class="function"><span class="keyword">function</span>(<span class="params"></span>) </span>&#123;</div><div class="line">    ctx.beginPath();</div><div class="line">    ctx.arc(<span class="keyword">this</span>.x, <span class="keyword">this</span>.y, <span class="keyword">this</span>.radius, <span class="number">0</span>, <span class="built_in">Math</span>.PI*<span class="number">2</span>, <span class="literal">true</span>);</div><div class="line">    ctx.closePath();</div><div class="line">    ctx.fillStyle = <span class="keyword">this</span>.color;</div><div class="line">    ctx.fill();</div><div class="line">  &#125;</div><div class="line">&#125;;</div><div class="line"><span class="function"><span class="keyword">function</span> <span class="title">draw</span>(<span class="params"></span>) </span>&#123;</div><div class="line">  <span class="comment">// 长尾效果</span></div><div class="line">  <span class="comment">//ctx.clearRect(0,0, canvas.width, canvas.height);</span></div><div class="line">  ctx.fillStyle = <span class="string">'rgba(255,255,255,0.3)'</span>;</div><div class="line">  ctx.fillRect(<span class="number">0</span>,<span class="number">0</span>,canvas.width,canvas.height);</div><div class="line">  <span class="comment">// 加速减速</span></div><div class="line">  <span class="comment">// ball.vy *= .99;</span></div><div class="line">  <span class="comment">// ball.vy += .25;</span></div><div class="line"></div><div class="line">  <span class="comment">//边界</span></div><div class="line">  <span class="keyword">if</span> (ball.y + ball.vy &gt; canvas.height || ball.y + ball.vy &lt; <span class="number">0</span>) &#123;</div><div class="line">    ball.vy = -ball.vy;</div><div class="line">  &#125;</div><div class="line">  <span class="keyword">if</span> (ball.x + ball.vx &gt; canvas.width || ball.x + ball.vx &lt; <span class="number">0</span>) &#123;</div><div class="line">    ball.vx = -ball.vx;</div><div class="line">  &#125;</div><div class="line">  ball.x += ball.vx;</div><div class="line">  ball.y += ball.vy;</div><div class="line">  ball.draw();</div><div class="line">  raf = <span class="built_in">window</span>.requestAnimationFrame(draw);</div><div class="line">&#125;</div><div class="line">canvas.addEventListener(<span class="string">'mouseover'</span>, <span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</div><div class="line">  raf = <span class="built_in">window</span>.requestAnimationFrame(draw);</div><div class="line">&#125;);</div><div class="line">canvas.addEventListener(<span class="string">"mouseout"</span>,<span class="function"><span class="keyword">function</span>(<span class="params">e</span>)</span>&#123;</div><div class="line">  <span class="built_in">window</span>.cancelAnimationFrame(raf);</div><div class="line">&#125;);</div><div class="line">ball.draw();</div></pre></td></tr></table></figure>
      
    </div>
    <footer class="article-footer">
      <a data-url="https://github.com/pavelShen/2017/07/11/canvas学习笔记-API（06）/" data-id="cj77t6la7000c7vvgzwv67w5d" class="article-share-link">Share</a>
      
      
  <ul class="article-tag-list"><li class="article-tag-list-item"><a class="article-tag-list-link" href="/tags/canvas/">canvas</a></li></ul>

    </footer>
  </div>
  
</article>



  


  <nav id="page-nav">
    <span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><a class="page-number" href="/page/3/">3</a><span class="space">&hellip;</span><a class="page-number" href="/page/5/">5</a><a class="extend next" rel="next" href="/page/2/">__('next') &raquo;</a>
  </nav>
</section>
          
            <aside id="sidebar">
  
    

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tags</h3>
    <div class="widget">
      <ul class="tag-list"><li class="tag-list-item"><a class="tag-list-link" href="/tags/canvas/">canvas</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/codewar/">codewar</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/css/">css</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/es6/">es6</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/hexo/">hexo</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/javascript/">javascript</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/koa/">koa</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/markdown/">markdown</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/nodejs/">nodejs</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/tools/">tools</a></li><li class="tag-list-item"><a class="tag-list-link" href="/tags/weixin/">weixin</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Tag Cloud</h3>
    <div class="widget tagcloud">
      <a href="/tags/canvas/" style="font-size: 16px;">canvas</a> <a href="/tags/codewar/" style="font-size: 14px;">codewar</a> <a href="/tags/css/" style="font-size: 10px;">css</a> <a href="/tags/es6/" style="font-size: 18px;">es6</a> <a href="/tags/hexo/" style="font-size: 10px;">hexo</a> <a href="/tags/javascript/" style="font-size: 20px;">javascript</a> <a href="/tags/koa/" style="font-size: 10px;">koa</a> <a href="/tags/markdown/" style="font-size: 10px;">markdown</a> <a href="/tags/nodejs/" style="font-size: 12px;">nodejs</a> <a href="/tags/tools/" style="font-size: 12px;">tools</a> <a href="/tags/weixin/" style="font-size: 12px;">weixin</a>
    </div>
  </div>

  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Archives</h3>
    <div class="widget">
      <ul class="archive-list"><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/09/">September 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/08/">August 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/07/">July 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/04/">April 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/02/">February 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2017/01/">January 2017</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/12/">December 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/09/">September 2016</a></li><li class="archive-list-item"><a class="archive-list-link" href="/archives/2016/08/">August 2016</a></li></ul>
    </div>
  </div>


  
    
  <div class="widget-wrap">
    <h3 class="widget-title">Recent Posts</h3>
    <div class="widget">
      <ul>
        
          <li>
            <a href="/2017/09/06/codewar-04/">codewar-04</a>
          </li>
        
          <li>
            <a href="/2017/09/05/codewar-03/">codewar-03</a>
          </li>
        
          <li>
            <a href="/2017/09/04/codewar-02/">codewar-02</a>
          </li>
        
          <li>
            <a href="/2017/09/03/codewar-01/">codewar-01</a>
          </li>
        
          <li>
            <a href="/2017/08/12/微信小程序跨页面通信解决思路/">微信小程序跨页面通信解决思路</a>
          </li>
        
      </ul>
    </div>
  </div>

  
</aside>
          
        </div>
        <footer id="footer">
  
  <div class="outer">
    <div id="footer-info" class="inner">
      &copy; 2017 pavelShen<br>
      Powered by <a href="http://hexo.io/" target="_blank">Hexo</a>
    </div>
  </div>
</footer>
      </div>
      <nav id="mobile-nav">
  
    <a href="/" class="mobile-nav-link">Home</a>
  
    <a href="/archives" class="mobile-nav-link">Archives</a>
  
    <a href="/demo" class="mobile-nav-link">Demo</a>
  
</nav>
      

<script src="//libs.baidu.com/jquery/1.9.1/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/script.js"></script>

    </div>
  
</body>
</html>
